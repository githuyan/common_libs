#### 并发处理之限流

#### 目的

1. 巨大流量的平滑过度
2. 自定义限流名单
3. 自定义限流策略
   1. 拒绝请求
   2. 延时处理
   3. 警告提醒
4. 流量数据统计

##### 没有限流可能会出现哪些问题

1. 大促场景的粗粒度限流，每秒都会有大量请求涌入，需要限制每一秒的流量数量
2. 作为服务接口的提供方，上游bug可能会导致某个时间的大量请求
3. 非预期流量的限流，恶意流量可能会占用过多的核心资源，导致正常请求服务超时或失败



#### 常用限流方式

##### 固定窗口算法

> 需要一个支持原子操作的计数器



##### 滑动窗口算法



##### 漏桶算法



#### 功能实现

##### 需要注意的问题

1. 前后钩子应当是同步的
2. 单机与分布式
3. 同步与异步
4. 多个限流策略叠加的情况
5. 限流间隔选择（100/s, 100/m）



#### 扩展

##### 流量削峰

阻塞式限流，超时否定

否决式限流，立刻否定

单机限流

分布式限流



##### 熔断